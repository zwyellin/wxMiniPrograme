 <import src="../../components/control/control.wxml" />
<import src="../../components/star/star.wxml" />
<import src="../template/shop/activity.wxml" />
<import src="../template/shop/manfull.wxml" />
<import src="../../components/showToast/showToast.wxml" />
<import src="shopSkeletonScreen.wxml"/><!--骨架屏-->
<wxs module="tage" src="../../utils/star.wxs"></wxs>
<template is="shopScreen" wx:if="{{isShopSkeletonScreenShow}}"></template> <!--商店整体骨架屏 -->

<view class="container page-index" wx:else>
	<!--新增的搜索 页面布局-->
	<view wx:if="{{isSearchWrapperShow}}" class="mask" style="z-index:20;background:#F8F8FF;opacity:1">
		<view class="shopSearch-wrapper font-14">
			<view class="shopSearch-header flex">
				<view class="shopSearch-header-l flex">
					<image src="../../images/images/search.png"></image>
					<input placeholder="请输入商品名(请输入有效词组)" placeholder-class="placeholder" bindfocus="shopSearchInput" confirm-type="search"
					value="{{searchValue}}" bindinput="shopSearchInput" data-reset="{{true}}" bindconfirm="shopSearchSubmit" focus="{{isShopSearchInputFocus}}"></input>
				</view>
				<view class="shopSearch-header-r" catch:tap="shopSearchSubmit" data-reset="{{true}}">
					<text style="{{searchInputValue.length>0 ? 'color:#ff9900' : ''}}">搜索</text>
				</view>
			</view>
			<!-- 搜索历史记录-->
			<view wx:if="{{isshopSearchRecordShow}}" class="shopSearchRecord">
				<view class="shopSearchRecord-header flex">
					<text>历史搜索</text>
					<image src="{{shopSearchRecord.length>0 ? '../../images/images/icon_dele-active.png' : '../../images/images/icon_dele.png'}}" catch:tap="shopSearchRecordDel"></image>
				</view>
				<view class="shopSearchRecord-main mt20 flex" >
					<block wx:for="{{shopSearchRecord}}"
						wx:for-index="index"
						wx:for-item="item"
						wx:key="index"
					>
						<text data-text="{{item}}" catch:tap="shopSearchRecordTap">{{item}}</text>
					</block>
				</view>
			</view>
			<!-- 搜索显示主体-->
			<view  wx:if="{{!isshopSearchRecordShow}}" class="shopSearch-main">
				<scroll-view  class="foods-wrapper" 
					scroll-y="true"
					lower-threshold="20"
					data-reset="{{false}}"
					bindscrolltolower="shopSearchSubmit"
					style="height:{{shopSearchScrollHeight}}px;"
					>
						<view class="food-item" 
							wx:for="{{searchResList}}" 
							wx:for-item="food" 
							wx:for-index="index" 
							wx:key="id"
							data-food="{{food}}"
							bindtap="selectefood">
							<view class="icon">  
								<!-- <image style="display: none" class="icon_img" src="{{tage.removefh(food.imgs,114,114)}}" data-parentindex="{{parentIndex}}" data-index="{{index}}" bindload="_imgOnLoad" />
								<image class="icon_img" src="{{food.isImgLoadComplete ? tage.removefh(food.imgs,114,114) : '/images/merchant/merchantLogo.png'}}" /> -->
								<image class="icon_img" lazy-load="true" src="{{tage.removefh(food.imgs,114,114)}}" />
							</view>
							<view class="content">
								<view class="detail-name">
									<text>{{food.name}}</text>
								</view>
								<view class="detail-descs">
									<text>{{food.description}}</text>
								</view>
								<view class="detail-extra">
									<text class="detail-count">月售{{food.monthSaled}}份</text>
									<text wx:if="{{tage.praise(food.commentScore) && food.monthSaled}}">好评率{{tage.praise(food.commentScore)}}%</text>
								</view>
								<view class="detail-price flex">
									<text class="now">¥{{tage.sortGoodsSpecList(food.goodsSpecList).price}}<text wx:if="{{food.goodsSpecList.length > 1}}"class="now-min">起</text><text wx:if="{{tage.sortGoodsSpecList(food.goodsSpecList).originalPrice}}" class="old-price">￥{{tage.sortGoodsSpecList(food.goodsSpecList).originalPrice}}</text>
									</text>
									<view class="cartcontrol-wrapper">
										<!-- if 如果休息-->
										<view wx:if="{{merchantInfoObj.businessStatus === 1 || merchantInfoObj.status=== 0}}" class="choice-else font-10"  ><!--如果代理商不允许它开业，或者它自己是休息状态：即显示商家休息-->
											<text>商家休息中</text>
										</view>
										<!-- else 在营业（if有可能规格一个的已售罄（及不再售卖）/正常卖）-->
										<view wx:elif="{{food.status === 0 || (food.status === 0 || food.goodsSpecList.length === 1 && food.goodsSpecList[0].stockType && !food.surplusDiscountStock && food.goodsSpecList[0].stock === 0 )}}" class="choice-else font-10">	
											<text>商品已售罄</text><!--不再售卖 或 （针对规格只有一个的，并且库存状态是有限的，并且不是折扣商品已卖完，并且库存数为0）-->
										</view>
										<view wx:else class="flex" style="align-items:center">
											<template is="contorl-add" data="{{food,selectFoods,parentIndex}}" ></template> <!--+购买图标-->
											<!-- （if有可能要选规格,对应多规格:也必须存在 contorl-add 模板）-->
											<view wx:if="{{food.goodsSpecList.length >1 || food.goodsAttributeList.length >=1}}" class="choice font-10" data-food="{{food}}" data-parent-index="{{parentIndex}}" catchtap="choice">
												<text>选规格</text>
											</view>
										</view>   
									</view>
								</view>
								<!-- 这个是在商品价格下面的商品信息文字提示-->
								<!--针对规格只有一个的，并且有限制的（库存有限 或 最少购买 或最多购买几个折扣商品）-->
								<view wx:if="{{food.goodsSpecList.length == 1 && (food.goodsSpecList[0].stockType || food.goodsSpecList[0].minOrderNum || food.everyGoodsEveryOrderBuyCount)}}" class="item-rules flex font-10">
									<!-- 折扣商品 的限购显示折扣状态及限购情况-->
									<block wx:if="{{food.hasDiscount === 1}}">
										<image class="discount-icon" src="../../images/images/discount_icon.png"></image>
										<text class="rules-discount-text" style="color:#fc524d">{{food.discountedGoods.discountProportion/10}}折</text>
										<text wx:if="{{food.everyGoodsEveryOrderBuyCount> 0}}" class="rules-text" style="color:#fc524d">每单限购{{food.everyGoodsEveryOrderBuyCount}}份</text>
									</block>	
									<!--普通商品 的限购-->
									<block wx:else>
										<!--普通商品如果有限购 ，显示限购信息-->
										<text wx:if="{{food.goodsSpecList[0].orderLimit}}" class="rules-text" style="color:#cd5c78;border: 1rpx solid #cd5c78">每单限购{{food.goodsSpecList[0].orderLimit}}份</text>
										<!--普通商品如果剩余数量不多，显示信息-->
										<text wx:if="{{food.goodsSpecList[0].stockType && food.goodsSpecList[0].stock <10 && food.goodsSpecList[0].stock >0}}" class="rules-text rules-left" style="color:#fff;border: 1rpx solid #ff4849;background: #ff4849">仅剩{{food.goodsSpecList[0].stock}}件</text>
										<!--普通商品有最少购买要求的，显示信息-->
										<text wx:if="{{food.goodsSpecList[0].minOrderNum >1 }}" class="rules-text rules-left" style="color:#fb9a00;border: 1rpx solid #fb9a00">{{food.goodsSpecList[0].minOrderNum}}份起购</text>
									</block>									
								</view>
							</view>
						</view><!-- food 列表 end-->
						<!--加载 底下信息-->
						<view wx:if="{{shopSearchLoading}}" class="loading-info" >
							<image src="../../images/merchant/loading.png" class="img-loading"></image>
							<view class="loading-text">正在加载，请稍候</view>
						</view>
						<view class="bottom-info" wx:elif="{{searchResList.length>10}}"><!--内容太短就不显示这条信息-->
     						<view class="bottom-text">我是有底线的</view>
						</view>
						<view class="bottom-info" wx:elif="{{searchResList.length==0}}">
     						<view class="bottom-text">没有搜索到相关商品</view>
    					</view>
			    </scroll-view>
			</view>
		</view>
	</view>
	<!--搜索页 end-->

	<!--以下为shop正常页-->
	<view class="header" wx:if="{{!isSearchWrapperShow}}">
		<!-- 搜索 -->
		<view class="padding-lr-40 padding-tb-20 flex flex-row-center flex-spaceBetween">
				<view  class="flex1 flex box-sizing-box flex-row-center"  catchtap="SearchIconTap"
				style="border-radius:30rpx;height:54rpx;line-height:54rpx;background:#f0f0f0;margin-right:40rpx;"> 
						<image class="flex0" src="../../images/images/search.png"  style="width:28rpx;height:28rpx;padding:0 20rpx;"/>
						<text style="font-size:24rpx;color:#999">请输入商品名</text>
				</view>
				<!-- 店家二维码icon -->
				<image class="flex0" src="../image/QRcodeIcon1.png" style="width:50rpx;height:50rpx;padding:6rpx 0rpx 6rpx 30rpx;" catch:tap="QRcodeIconTap"/>
				<!-- 悬浮框 -->
				<mask position="center" wx:if="{{QRcode_mask_show}}" catch:maskclick="maskCancelTap">
					<view  style="background:white;border-radius:20rpx;margin:200rpx 80rpx 0 80rpx;text-align:center;padding:60rpx;">
							<image src="{{WXQRImage}}" style="width:400rpx;height:400rpx;" data-images="{{WXQRImage}}" catch:tap="saveQRCode"/>
							<view style="font-size:28rpx;color:#666;margin-top:40rpx;">点击二维码可以进行分享或保存</view>
					</view>
				</mask>
		</view>
		<view class="content-wrapper">
			<view class="avatar">
				<image class="icon-image" src="{{merchantInfoObj.logo}}" ></image>	
			</view>
			<view class="content" >
				<view class="desc" style="{{merchantInfoObj.promotionActivityList.length === 0 ? 'margin-top: 29rpx' : ''}};position:relative">
					<text class="count-right">起送价</text>
					<text>￥{{merchantInfoObj.minPrice}}</text>
					<text class="count">|</text>
					<text class="count-right">配送费</text>
					<text>￥{{merchantInfoObj.shipFee-merchantInfoObj.merchantAssumeAmt}}</text>
					<text class="count">|</text>
					<text>{{merchantInfoObj.avgDeliveryTime}}分钟送达</text>
				</view>
				<view class="cartcontrol-wrapper flex flex-row-center flex-spaceBetween">
					<swiper autoplay="true" circular="true"  class="flex1"
						vertical="true" interval="3000" duration="500" style="height: 30rpx">
						<swiper-item class="cartcontrol-content flex"
							wx:for="{{merchantInfoObj.promotionActivityList}}" 
		      				wx:for-index="idx" 
		      				wx:for-item="promotion"
		      				wx:key="idx" >
							<image class="bran" src="{{promotion.promoImg}}"></image>
							<text class="name">{{promotion.promoName}}</text>
						</swiper-item>
					</swiper>
					<view wx:if="{{merchantInfoObj.promotionActivityList.length > 0}}" 
						class="flex0" bindtap="broadcast" style="margin-top: 6rpx;margin-right: -5rpx">
						<text>{{merchantInfoObj.promotionActivityList.length}}个活动</text>
						<image class="desc-img" src="../../images/images/down.png"></image>	
					</view>	
				</view>
			</view>  
		</view>
		<view class="bulletin-wrapper">
			<image class="bulletin-title" src="../../images/images/video.png"></image>
			<text class="bulletin-text">{{merchantInfoObj.broadcast}}</text>
			<image class="icon-arrow_lift" src="../../images/images/down.png"></image>
		</view>
	</view>

	<view class="tab" wx:if="{{!isSearchWrapperShow}}">
      <view class="item-tab flex {{index===tabIndex ? 'item-tab-avtive' : ''}}"
      wx:for="{{tab.tabList}}"   
      wx:for-item="item"
      wx:for-index="index" 
      wx:key="index" 
      bindtap="selectTab" data-index="{{index}}">
        <text>{{item}}</text>
        <image wx:if="{{merchantInfoObj.hasVisualRestaurant === 1 && index == 2}}" class="extra-img fr" src="/images/images/can_see.png"></image>
      </view>
    </view>
    <!-- 外卖商品 开始 -->
    <view wx:if="{{tab.cur==='商品' && merchantType == 0}}" class="goods">
    	<scroll-view class="menu-wrapper" 
    		scroll-y="true"
    		style="height:{{windowScrollHeight-48}}px"
    		scroll-into-view="{{leftToView}}" >
	    	<block 
		    	wx:for="{{menu}}" 
		    	wx:for-item="item" 
		    	wx:for-index="index" 
		    	wx:key="index">
		    	<view wx:if="{{item.goodsList != null}}" class="menu-item {{currentCateno=='A'+(index+1) ? 'active' : 'normal'}}" data-cateno="A{{index+1}}" id="l_A{{index+1}}" bindtap="scrollLeftTap">
					<text class="menu-item-text">
						<text wx:if="{{item.icon}}" class="text" style="background: url({{item.icon}});background-size: 24rpx 24rpx"></text>
						<text>{{item.name}}</text>
					</text>
					<text wx:if="{{tage.getItemCount(item.id,selectFoods) > 0}}" class="menu-item-num">{{tage.getItemCount(item.id,selectFoods)}}</text>
		    	</view>	
			</block>
		</scroll-view>
		<scroll-view  class="foods-wrapper" 
			scroll-y="true"
			style="height:{{windowScrollHeight-48}}px"
			scroll-into-view="{{rightToView}}" 
			bindscroll="rightScroll" >
		    <block
		    wx:for="{{menu}}" 
		    wx:for-item="item" 
		    wx:for-index="parentIndex" 
		    wx:key="parentIndex" >
		    <view wx:if="{{item.goodsList != null}}" data-cateno="A{{parentIndex+1}}" id="r_A{{parentIndex+1}}">
				<text class="food-title">{{item.name}}</text>
				<view class="food-item" 
					wx:for="{{item.goodsList}}" 
				    wx:for-item="food" 
				    wx:for-index="index" 
				    wx:key="id"
				    data-food="{{food}}"
				    data-parent-index="{{parentIndex}}"
				    bindtap="selectefood">
					<view class="icon">  
						<!-- <image style="display: none" class="icon_img" src="{{tage.removefh(food.imgs,114,114)}}" data-parentindex="{{parentIndex}}" data-index="{{index}}" bindload="_imgOnLoad" />
						<image class="icon_img" src="{{food.isImgLoadComplete ? tage.removefh(food.imgs,114,114) : '/images/merchant/merchantLogo.png'}}" /> -->
						<image class="icon_img" lazy-load="true" src="{{tage.removefh(food.imgs,114,114)}}" />
					</view>
					<view class="content">
						<view class="detail-name">
							<text>{{food.name}}</text>
						</view>
						<view class="detail-descs">
							<text>{{food.description}}</text>
						</view>
						<view class="detail-extra">
							<text class="detail-count">月售{{food.monthSaled}}份</text>
							<text wx:if="{{tage.praise(food.commentScore) && food.monthSaled}}">好评率{{tage.praise(food.commentScore)}}%</text>
						</view>
						<view class="detail-price flex">
							<text class="now">¥{{tage.sortGoodsSpecList(food.goodsSpecList).price}}<text wx:if="{{food.goodsSpecList.length > 1}}"class="now-min">起</text><text wx:if="{{tage.sortGoodsSpecList(food.goodsSpecList).originalPrice}}" class="old-price">￥{{tage.sortGoodsSpecList(food.goodsSpecList).originalPrice}}</text>
							</text>
							<view class="cartcontrol-wrapper">
								<!-- if 如果休息-->
								<view wx:if="{{merchantInfoObj.businessStatus === 1 || merchantInfoObj.status=== 0}}" class="choice-else font-10"  ><!--如果代理商不允许它开业，或者它自己是休息状态：即显示商家休息-->
									<text>商家休息中</text>
								</view>
								<!-- else 在营业（if有可能规格一个的已售罄（及不再售卖）/正常卖）-->
								<view wx:elif="{{food.status === 0 || (food.status === 0 || food.goodsSpecList.length === 1 && food.goodsSpecList[0].stockType && !food.surplusDiscountStock && food.goodsSpecList[0].stock === 0 )}}" class="choice-else font-10">	
									<text>商品已售罄</text><!--不再售卖 或 （针对规格只有一个的，并且库存状态是有限的，并且不是折扣商品已卖完，并且库存数为0）-->
								</view>
								<!--else 正常卖 -->
								<view wx:else class="flex" style="align-items:center">
									<template is="contorl-add" data="{{food,selectFoods,parentIndex}}" ></template> <!--+购买图标-->
									<!-- （if有可能要选规格,对应多规格:也必须存在 contorl-add 模板）-->
									<view wx:if="{{food.goodsSpecList.length >1 || food.goodsAttributeList.length >=1}}" class="choice font-10" data-food="{{food}}" data-parent-index="{{parentIndex}}" catchtap="choice">
										<text>选规格</text>
									</view>
								</view> 
							</view>
						</view>
						<!-- 这个是在商品价格下面的商品信息文字提示-->
						<!--针对规格只有一个的，并且有限制的（库存有限 或 最少购买 或最多购买几个折扣商品）-->
						<view wx:if="{{food.goodsSpecList.length == 1 && (food.goodsSpecList[0].stockType || food.goodsSpecList[0].minOrderNum || food.everyGoodsEveryOrderBuyCount)}}" class="item-rules flex font-10">
							<!-- 折扣商品 的限购显示折扣状态及限购情况-->
							<block wx:if="{{food.hasDiscount === 1}}">
								<image class="discount-icon" src="../../images/images/discount_icon.png"></image>
								<text class="rules-discount-text" style="color:#fc524d">{{food.discountedGoods.discountProportion/10}}折</text>
								<text wx:if="{{food.everyGoodsEveryOrderBuyCount> 0}}" class="rules-text" style="color:#fc524d">每单限购{{food.everyGoodsEveryOrderBuyCount}}份</text>
							</block>	
							<!--普通商品 的限购-->
							<block wx:else>
								<!--普通商品如果有限购 ，显示限购信息-->
								<text wx:if="{{food.goodsSpecList[0].orderLimit}}" class="rules-text" style="color:#cd5c78;border: 1rpx solid #cd5c78">每单限购{{food.goodsSpecList[0].orderLimit}}份</text>
								<!--普通商品如果剩余数量不多，显示信息-->
								<text wx:if="{{food.goodsSpecList[0].stockType && food.goodsSpecList[0].stock <10 && food.goodsSpecList[0].stock >0}}" class="rules-text rules-left" style="color:#fff;border: 1rpx solid #ff4849;background: #ff4849">仅剩{{food.goodsSpecList[0].stock}}件</text>
								<!--普通商品有最少购买要求的，显示信息-->
								<text wx:if="{{food.goodsSpecList[0].minOrderNum >1 }}" class="rules-text rules-left" style="color:#fb9a00;border: 1rpx solid #fb9a00">{{food.goodsSpecList[0].minOrderNum}}份起购</text>
							</block>									
						</view>
					</view>
				</view>
			</view>
		</block>
		<!--加载时的骨架屏-->
		</scroll-view>
    </view>
    <!-- 商品 结束 -->

	<!-- 外卖大容量商品 开始 -->
    <view wx:if="{{tab.cur==='商品' && merchantType == 1}}" class="goods">
    	<scroll-view class="menu-wrapper" 
    		scroll-y="true"
    		style="height:{{windowScrollHeight-48}}px"
    		scroll-into-view="{{leftToView}}" >
	    	<block 
		    	wx:for="{{menu}}" 
		    	wx:for-item="item" 
		    	wx:for-index="index" 
		    	wx:key="index" >
		    	<view class="menu-item {{currentCateno=='A'+(index+1) ? 'active' : 'normal'}}" data-cateno="A{{index+1}}" data-index="{{index}}" id="l_A{{index+1}}" bindtap="scrollLeftTap">
					<text class="menu-item-text">
						<text wx:if="{{item.icon}}" class="text" style="background: url({{item.icon}});background-size: 24rpx 24rpx">
						</text>{{item.name}}
					</text>
					<text wx:if="{{tage.getItemCount(item.id,selectFoods) > 0}}" class="menu-item-num">{{tage.getItemCount(item.id,selectFoods)}}</text>
		    	</view>	
			</block>
		</scroll-view>
		<scroll-view  class="foods-wrapper" 
			scroll-y="true"
			style="height:{{windowScrollHeight-48}}px"
			scroll-top="{{scrollTop}}" 
			bindscrolltolower="loadMoreGoods">
				<view class="food-item" 
					wx:for="{{itemCategoryList}}" 
				    wx:for-item="food" 
				    wx:for-index="index" 
				    wx:key="id"
				    data-food="{{food}}"
				    bindtap="selectefood">
					<view class="icon">
						<image class="icon_img" lazy-load="true" src="{{tage.removefh(food.imgs,114,114)}}" />
					</view>
					<view class="content">
						<view class="detail-name">
							<text>{{food.name}}</text>
						</view>
						<view class="detail-descs">
							<text>{{food.description}}</text>
						</view>
						<view class="detail-extra">
							<text class="detail-count">月售{{food.monthSaled}}</text>
							<text wx:if="{{tage.praise(food.commentScore) && food.monthSaled}}">好评率{{tage.praise(food.commentScore)}}%</text>
						</view>
						<view class="detail-price flex">
							<text class="now">¥{{tage.sortGoodsSpecList(food.goodsSpecList).price}}<text wx:if="{{tage.sortGoodsSpecList(food.goodsSpecList).originalPrice}}" class="old-price">￥{{tage.sortGoodsSpecList(food.goodsSpecList).originalPrice}}<text class="del"></text></text>
							</text>
							<view class="cartcontrol-wrapper">
								<view wx:if="{{merchantInfoObj.businessStatus === 1 || merchantInfoObj.status=== 0}}" class="choice-else font-10"  ><!--如果代理商不允许它开业，或者它自己是休息状态：即显示商家休息-->
									<text>商家休息中</text>
								</view>
								<!-- else 在营业（if有可能规格一个的已售罄（及不再售卖）/正常卖）-->
								<view wx:elif="{{food.status === 0 || (food.status === 0 || food.goodsSpecList.length === 1 && food.goodsSpecList[0].stockType && !food.surplusDiscountStock && food.goodsSpecList[0].stock === 0 )}}" class="choice-else font-10">	
									<text>商品已售罄</text><!--不再售卖 或 （针对规格只有一个的，并且库存状态是有限的，并且不是折扣商品已卖完，并且库存数为0）-->
								</view>
								<!--else 正常卖-->
								<view wx:else class="flex" style="align-items:center">
									<template is="contorl-add" data="{{food,selectFoods}}" ></template> <!--+购买图标-->
									<!--（if有可能要选规格）-->
									<view wx:if="{{food.goodsSpecList.length >1 || food.goodsAttributeList.length >=1}}" class="choice font-10" data-food="{{food}}" data-parent-index="{{parentIndex}}" catchtap="choice">
										<text>选规格</text>
									</view>
								</view> 
							</view>
						</view>
						<view wx:if="{{food.goodsSpecList.length == 1 && (food.everyGoodsEveryOrderBuyCount || food.goodsSpecList[0].stockType || food.goodsSpecList[0].minOrderNum)}}" class="item-rules flex font-10">
							<text wx:if="{{food.discountedGoods}}"class="rules-discount-text" style="color:#fc524d">{{food.discountedGoods.discountProportion/10}}折</text>
							<text wx:if="{{food.hasDiscount === 0 && food.goodsSpecList[0].orderLimit}}" class="rules-text" style="color:#cd5c78;border: 1rpx solid #cd5c78">每单限购{{food.goodsSpecList[0].orderLimit}}份</text>
							<text wx:if="{{food.hasDiscount === 1 && food.everyGoodsEveryOrderBuyCount> 0}}" class="rules-text" style="color:#fc524d">每单限购{{food.everyGoodsEveryOrderBuyCount}}份</text>
							<text wx:if="{{food.goodsSpecList[0].stockType && food.goodsSpecList[0].stock <10 && food.hasDiscount === 0&& food.goodsSpecList[0].stock >0}}" class="rules-text rules-left" style="color:#fff;border: 1rpx solid #ff4849;background: #ff4849">仅剩{{food.goodsSpecList[0].stock}}件</text>
							<text wx:if="{{food.goodsSpecList[0].minOrderNum >1 && food.hasDiscount === 0}}" class="rules-text rules-left" style="color:#fb9a00;border: 1rpx solid #fb9a00">{{food.goodsSpecList[0].minOrderNum}}份起购</text>
						</view>
					</view>
				</view>
				<!---->
				<!--加载时的骨架屏-->
				<template is="goodItemScreen" wx:if="{{!goodsMoreLoading && itemCategoryList.length > 10}}"></template>
				<view class="loading-info" wx:if="{{!goodsMoreLoading && itemCategoryList.length > 10}}" style="padding: 0">
			        <image src="/images/merchant/loading.png" class="img-loading"></image>
			    </view>
		</scroll-view>
    </view>
	<!-- 商品 结束 -->
	
    <!--新版评价页面-->
   <scroll-view 
    	hidden="{{tab.cur!='评价'}}" 
    	class="new-evaluate"
    	scroll-y="true"
    	style="height:{{windowScrollHeight}}px"
    	bindscrolltolower="loadMore">
    	<view class="new-evaluate-header">
		   <view class="new-evaluate-userinfo">
		       <view>
			      <text class="new-evaluate-userinfo-number">{{tage.formatFloat(merchantInfoObj.averageScore,1)}}</text>
			   </view>
			   <view class="new-evaluate-userinfo-star">
				   <text class="new-evaluate-userinfo-star-text">商家评分</text>
				   <template is="star-AttrScore" data="{{size:36,item:merchantInfoObj,AttrName:'averageScore'}}"></template>
			   </view>
		   </view>
		   <view class="new-evaluate-right">
			   <view class="new-evaluate-right-item">
				   <text class="new-evaluate-right-text">味道</text>
				   <text class="new-evaluate-right-number">{{tage.formatFloat(merchantInfoObj.tasteScore,1)}}</text>
			   </view>
			   <view class="new-evaluate-right-item">
				   <text class="new-evaluate-right-text">包装</text>
				   <text class="new-evaluate-right-number">{{tage.formatFloat(merchantInfoObj.packagingScore,1)}}</text>
			   </view>
			    <view class="new-evaluate-right-item" style="padding-left:50rpx;border-left:1px solid #e9e9e9">
				   <text class="new-evaluate-right-text">配送</text>
				   <text class="new-evaluate-right-number">{{tage.formatFloat(merchantInfoObj.shipScore,1)}}</text>
			   </view>
			</view>
	    </view>
		<view class="new-valuate-content">
          <view class="new-valuate-content-header">
			  <view class="new-valuate-content-btns">
			    <button class="new-valuate-btn1 {{selestEvaluateStatus == 0 ? 'new-valuate-btn-hover1':''}}"  data-id='0'  catch:tap="evaluateBtnSwitch">全部<text>{{evaluate.allCount}}</text></button>
			    <button class="new-valuate-btn1 {{selestEvaluateStatus == 1 ? 'new-valuate-btn-hover1':''}}"  data-id='1'  catch:tap="evaluateBtnSwitch">好评<text>{{evaluate.goodCount}}</text></button>
			    <button class="new-valuate-btn2 {{selestEvaluateStatus == 2 ? 'new-valuate-btn-hover2':''}}"  data-id="2"  catch:tap="evaluateBtnSwitch">差评<text>{{evaluate.poorCount}}</text></button>
			    <button class="new-valuate-btn1 {{selestEvaluateStatus == 3 ? 'new-valuate-btn-hover1':''}}"  data-id="3"  catch:tap="evaluateBtnSwitch">有图<text>{{evaluate.imgCount}}</text></button>
			  </view>
			  <view class="new-valuate-checkbox" catch:tap="merchantComIsFilterEmptySwitch">
				<icon type="success" color="{{isHaveContent==1 ? 'green':'grey'}}" size="11" style="margin-right:10rpx;vertical-align:middle"></icon><text>只看有内容的评价</text>
			  </view>
		  </view>
		  <view class="new-valuate-content-main">
                <block wx:for="{{evaluate.list}}" wx:key="{{item.id}}">
					<view class="new-valuate-item" >
						<view class="new-valuate-item-userinfo">
							<view class="new-evaluate-userinfo">				
								<image class="new-evaluate-userinfo-image" src="{{item.appUser.headerImg!='' ? item.appUser.headerImg:'../image/headerImage.png'}}"></image>
								<view class="new-evaluate-userinfo-star" style="margin-left:10rpx;">
									<text class="new-evaluate-userinfo-star-text">{{item.isAnonymous==1? '匿名用户' : tage.strReplace(item.appUser.name)}}</text>
									<template is="star-AttrScore" data="{{size:36,item,AttrName:'merchantScore'}}" ></template>
									<text style="vertical-align:text-bottom;color:#ff9900;font-size:22rpx;">{{tage.numberToText(item.merchantScore)}}</text>
								</view>
							</view>
							<view class="new-evaluate-userinfo-time">
								<text>{{item.createTime}}</text>
							</view>
						</view><!--评论的头像，名字，时间。部分结束-->
						<view class="new-valuate-item-main"><!--评论内容开始 主内容 -->
							<text class="new-valuate-item-mainText" wx:if="{{!item.merchantComments}}" style="color:#9a9a9a">该用户没有做具体评价哦！</text><!--顾客评价-->
							<text class="new-valuate-item-mainText" wx:else>{{item.merchantComments}}</text><!--顾客评价-->
							<view class="new-valuate-item-main-images flex" wx:if="{{item.isImg==1}}">
							    <block wx:for="{{tage.splitStrToArr(item.imgUrl,';','true','198')}}"
								       wx:key="imgIndex"
								       wx:for-item="imgItem"
									   wx:for-index="imgIndex"><!--tage.splitStrToArr 参数为：要解析的字符串，分隔符，是否图片加高清，高清图片的宽度-->
									<image src="{{imgItem ? imgItem : '../images/merchant/merchantLogo.png'}}" class="new-valuate-item-main-image"
									 catch:tap="valuateItemImageTap" data-current="{{imgIndex}}" data-imgs="{{tage.splitStrToArr(item.imgUrl,';','true',windowWidth)}}"
									 style="margin-right:{{(imgIndex+1)%3==0 ? '':'16rpx'}};margin-top:16rpx"></image>
								</block>		
							</view>
							<text class="new-valuate-item-mainText mt20" wx-if="{{item.replyContent!==null}}"><text>商家回复:</text>{{item.replyContent}}</text><!--商家回复-->
							<view  wx:if="{{item.goodsCommentsList.length!=0}}"><!--赞，踩列表-->
								<view wx:if="{{tage.filterEvaluateScore(item.goodsCommentsList).goodScores.length>0}}" class="new-valuate-item-icon flex">
									<image src="../image/zan.png"></image><!-- 赞-->
									<view class="new-valuate-item-iconText">
										<block wx:for="{{tage.filterEvaluateScore(item.goodsCommentsList).goodScores}}"
											wx:for-index="goodsIndex"
											wx:for-item="goodsItem"
											wx:key="orderId">
											<text>{{goodsItem.goodsName}}</text>
										</block>
									</view>
								</view>
								<view wx:if="{{tage.filterEvaluateScore(item.goodsCommentsList).badScores.length>0}}" class="new-valuate-item-icon flex" style="margin-top:{{tage.filterEvaluateScore(item.goodsCommentsList).goodScores.length>0 ? '' : '20rpx'}};">
									<image src="../image/cai.png"></image><!--踩-->
									<view class="new-valuate-item-iconText">
										<block wx:for="{{tage.filterEvaluateScore(item.goodsCommentsList).badScores}}"
											wx:for-index="goodsIndex"
											wx:for-item="goodsItem"
											wx:key="id">
											<text>{{goodsItem.goodsName}}</text>
										</block>
								    </view>
								</view>
							</view>
					   </view>
					</view>
			    </block>
		    </view><!--content-main结束：即评论部分-->
		 </view>
		 	<view class="loading-info" wx:if="{{!loading && evaluate.list.length > 4}}">
	        <image src="../../images/merchant/loading.png" class="img-loading"></image>
	        <view class="loading-text">正在加载，请稍候</view>
	    </view>
	    <view class="bottom-info" wx:if="{{loading}}">
     		<view class="bottom-text">暂无更多评价</view>
    	</view>
	</scroll-view>
    <!-- 商家 开始 -->
    <view wx:if="{{tab.cur==='商家'}}" class="shop">
    	<view class="shop-header font-12">
    		<view class="shop-text font-14">
    			<text>{{merchantInfoObj.name}}</text>
    		</view>
				<view class="shop-text" style="margin-top:16rpx">
    			<template is="star-AttrScore" data="{{size,item:merchantInfoObj,AttrName:'averageScore'}}"></template>
    			<text style="color:#ff9900;margin-left:10rpx">{{tage.shopFloat(merchantInfoObj.averageScore,1)}}分</text>
    			<text style="color:#666;margin-left:20rpx">月售{{merchantInfoObj.monthSaled}}单</text>
    		</view>
    	</view>
    	<view class="user-center">
  			<view class="user-message">
  				<view class="font-12"><text >起送价</text></view>
  				<view class="mt10"><text style="color:#333" >{{merchantInfoObj.minPrice}}元</text></view>
  			</view>
  			<view wx:if="{{merchantInfoObj.shipmentMode === 2}}" class="user-message">
  				<view class="font-12"><text>第三方配送</text></view>
  				<view class="mt10"><text style="color:#333">{{merchantInfoObj.shipFee}}元</text></view>
  			</view>
  			<view wx:if="{{merchantInfoObj.shipmentMode === 1}}" class="user-message">
  				<view class="font-12"><text>商家自配送</text></view>
  				<view class="mt10"><text style="color:#333">{{merchantInfoObj.shipFee || 0}}元</text></view>
  			</view>
  			<view class="user-message">
  				<view class="font-12"><text>平均配送时间</text></view>
  				<view class="mt10"><text style="color:#333">{{merchantInfoObj.avgDeliveryTime}}分钟</text></view>
  			</view>
  		</view>
  		<view wx:if="{{merchantInfoObj.visualRestaurantList && merchantInfoObj.visualRestaurantList.length != 0}}" class="shop-content font-16">
  			<view class="shop-message shop-message-letter" style="color:#666;padding-left: 10rpx;border: none">
  				<text>可视餐厅</text>
  			</view>
  			<scroll-view scroll-x="true" style="width: 100%;height: 166rpx;padding-bottom: 20rpx">
  				<view class="flex">
					<block
						wx:for="{{merchantInfoObj.visualRestaurantList}}"   
				      	wx:for-item="item"
				      	wx:for-index="index" 
				      	wx:key="index">
			      		<navigator class="video-content" url="/goods/video/video">
				      		<image class="video-logo" src="{{tage.removefh(item.videoPic,248,166)}}"></image>
				      		<image class="video-top" src="/images/merchant/video_top.png"></image>
				      		<view class="video-bottom flex">
				      			<image class="extra-video-img" src="/images/images/can_see.png"></image>
				      			<text class="font-12" style="color:#fff;margin-left:10rpx">{{item.positionName}}</text>
				      		</view>
				      	</navigator>
			      	</block>
			    </view>   	
  			</scroll-view>
  		</view>
  		<view class="shop-content font-16">
  			<view class="shop-message shop-message-letter" style="color:#666;padding-left: 10rpx">
  				<text>商家信息</text>
  			</view>
			<view class="shop-message flex" bindtap="merchantAddress">
				<view class="merchant-address flex-item">
					<text class="shop-message-letter">商家地址:</text>
  					<text class="shop-message-letter shop-left">{{merchantInfoObj.address}}</text>
				</view>
  				<view class="address_icon flex">
  					<image class="map_icon" src="/images/images/map_1.png"></image>
  				</view>
  			</view>
  			<view class="shop-message">
  				<text class="shop-message-letter">营业时间:</text>
  				<text class="shop-message-letter shop-left">{{merchantInfoObj.workingTime}}</text>
  			</view>
  			<view class="shop-message" bindtap="callPhone">
  				<text class="shop-message-letter">电话:</text>
  				<text class="shop-message-letter shop-left">{{merchantInfoObj.contacts}}</text>
  			</view>
  		</view>
  		<view class="shop-content font-16">
  			<view class="shop-message shop-message-letter" style="color:#666">
  				<text>商家公告</text>
  			</view>
  			<view class="shop-message-letter shop-flex font-14" style="color:#bc4500">
  				<text>{{merchantInfoObj.broadcast || '商家暂无公告'}}</text>
  			</view>
  		</view>
  		<view class="shop-content font-18">
  			<view class="shop-message shop-message-letter" >
  				<text>活动与支持</text>
  			</view>
  			<view class="query-message font-12 clearfix"
				wx:for="{{merchantInfoObj.promotionActivityList}}" 
				wx:for-index="idx" 
				wx:for-item="promotion"
				wx:key="idx">
				<view class="fl font-14">
					<image class="bran-img" src="{{promotion.promoImg}}"></image>
					<text>{{promotion.promoName}}</text>
				</view>
			</view>
  		</view>
  		<view class="shop-content font-18" wx:if="{{merchantInfoObj.businessLicenseImg || merchantInfoObj.hygieneLicenseImg}}">
  			<view class="shop-message shop-message-letter" >
  				<text>商家资质</text>
  			</view>
  			<view class="merchant-aptitude flex">
  				<view class="merchant-aptitude-img">
  					<image class="aptitude-img" src="{{merchantInfoObj.businessLicenseImg}}?imageView2/0/w/560/h/380/q/100!" 
  						  data-id="0" 
						  data-imgs="{{[merchantInfoObj.businessLicenseImg,merchantInfoObj.hygieneLicenseImg]}}"
  						catchtap="scaleImg">	
  					</image>
  				</view>
  				<view class="merchant-aptitude-img">
  					<image class="aptitude-img" src="{{merchantInfoObj.hygieneLicenseImg}}?imageView2/0/w/560/h/380/q/100!" 
  						data-id="1"
 						data-imgs="{{[merchantInfoObj.businessLicenseImg,merchantInfoObj.hygieneLicenseImg]}}"
  						catchtap="scaleImg">	
  					</image>
  				</view>
  			</view>
  		</view>
    </view>
    <!-- 商家 结束 -->
	<!--购物车-->
	<view wx:if="{{tab.cur==='商品'}}" class="shopcart">
		<view wx:if="{{totalcount===0 && ruleDtoList.length > 0 && !activitySharedShow || !fold && ruleDtoList.length>0 && !isShowTogether && !activitySharedShow}}" class="shopcart-list-top lisTop">
			<text 
			wx:if="{{totalcount === 0 }}"
				wx:for="{{ruleDtoList}}"
				wx:for-index="index"
				wx:for-item="ruletion"
				wx:key="index"
				>满{{ruletion.full}}减{{ruletion.sub}}<text wx:if="{{index != ruleDtoList.length-1}}">, </text>  </text>
			<view wx:if="{{totalcount > 0}}" catchtap="boosLisr">
				<template is="full" data="{{totalcount,ruleDtoList,totalprice,fullPrice,isTogether}}"></template>
			</view>	
		</view>
		<view class="content">
			<view class="contet-left">
				<view class="logo-wrapper" >
					<view class="logo" bindtap="showFood">
						<image wx:if="{{totalcount===0}}" class="logo" src="/images/images/cart_1.png"></image>
						<image wx:if="{{totalcount>0}}" class="logo" src="/images/images/cart_2.png"></image>
					</view>
					<view wx:if="{{totalcount>0}}" class="num">
						<text>{{totalcount}}</text>
					</view>
				</view>
				<view class="price" style="color:#fff"><text>￥{{totalprice}}</text></view>
				<text class="desc" style="color:#fff">另需配送费¥{{merchantInfoObj.shipFee-merchantInfoObj.merchantAssumeAmt}}</text>
			</view>
			<view class="content-right" bindtap="checkOut">
				<view class="pay {{ totalprice>=minPrice ? 'enough' : 'not-enough'}}" >
					<text>{{tage.payDesc(totalprice,minPrice)}}</text>
				</view>
			</view>
		</view>
		<view wx:if="{{isShowTogether&&totalcount>0&& !activitySharedShow}}"  class="shopcart-list">
			<view class="shopcart-list-top">
				<view catchtap="boosList">
					<template is="full" data="{{totalcount,ruleDtoList,totalprice,fullPrice,isTogether}}"></template>
				</view>
			</view>
			<scroll-view
				class="list-content"
				scroll-y="true"
				style="{{listFoods.length>=4 ? 'height:328rpx': ''}}">
				<block
					wx:for="{{listFoods}}" 
					wx:for-item="food" 
					wx:for-index="index" 
					wx:key="index">
					<view class="food" ><!-- 购物车展示的列表-->
						<view class="name food-name">{{food.name}}
							<text wx:if="{{food.priceObject.spec}}">({{food.priceObject.spec}})</text>
							<text wx:if="{{food.attributes}}">{{food.attributes}}</text>
						</view>
						<view class="price">
							<text>￥{{tage.shopFloat(food.priceObject.price,2)}}</text>
						</view>
						<view class="cartcontrol-wrapper">
							<view class="control" style="height: 72rpx">
								<view  class="cart-decrease" data-food="{{food}}" catchtap="decrease">
									<image class="icon-add_circle" src="/images/images/decrease.png"></image>
								</view>
								<view  class="cart-count">
									<text>{{tage.fullItemNum(food,selectFoods)}}</text>
								</view>
								<view class="cart-add" data-food="{{food}}" data-full-activity="{{true}}" catchtap="addCart">
									<image class="icon-add_circle" src="/images/images/add.png"></image>
								</view>
							</view>
						</view>
					</view>
				</block>
			</scroll-view>
		</view>
		<view wx:if="{{fold}}" class="shopcart-list">
			<view wx:if="{{ruleDtoList.length>0 && !activitySharedShow}}" class="shopcart-list-top">
				<view wx:if="{{selectFoods.length>0}}" catchtap="boosLisr">
					<template is="full" data="{{totalcount,ruleDtoList,totalprice,fullPrice,isTogether}}"></template>
				</view>		
			</view>
			<view class="list-header"wx:if="{{!isShowTogether}}" >
				<text class="list-title">购物车</text>
				<text class="empty" bindtap="empty">清空</text>
			</view>
			<scroll-view class="list-content" 
				scroll-y="true" 
				style="{{selectFoods.length>=4 ? 'height:328rpx': ''}}" >
				<block
					wx:for="{{selectFoods}}" 
				    wx:for-item="food" 
				    wx:for-index="index" 
				    wx:key="index">
					<view class="food" >
						<view class="name food-name">{{food.name}}
							<text wx:if="{{food.priceObject.spec}}">({{food.priceObject.spec}})</text>
							<text wx:if="{{food.attributes}}">{{food.attributes}}</text>
						</view>
						<view class="price">
							<!-- <text wx:if="{{food.everyGoodsEveryOrderBuyCount==0}}">￥{{tage.shopFloat(food.priceObject.price*food.count,2)}}</text>
							<text wx:if="{{food.everyGoodsEveryOrderBuyCount!=0}}">￥{{tage.shopFloat(price,1)}}</text> -->
							<text>￥{{tage.price(food,userDiscountGoodsList)}}</text>
						</view>
						<view class="cartcontrol-wrapper">
							<view class="control" style="height: 72rpx">
								<view wx:if="{{food.count>0}}" class="cart-decrease" data-food="{{food}}" catchtap="decrease">
									<image class="icon-add_circle" src="/images/images/decrease.png"></image>
								</view>
								<view wx:if="{{food.count>0}}" class="cart-count">
									<text>{{food.count}}</text>
								</view>
								<view class="cart-add" data-food="{{food}}" catchtap="addCart">
									<image class="icon-add_circle" src="/images/images/add.png"></image>
								</view>
							</view>
						</view>
					</view>
				</block>
			</scroll-view>
		</view>
	</view>
	<!--点击商品进详情页-->
	<view wx:if="{{detailShow}}" animation="{{choiceAnimation}}" class="shopdetail" catchtouchmove="myCatchTouch">
		<view class="detail-content">
			<image class="detail-img" src="{{tage.removefh(selectedFood.imgs,642,656)}}"></image>
			<view class="detail-title">
				<text style="text-indent: 32rpx">味道美味</text>
			</view>	
		</view>
		<view class="selectdetail-desc selectdetail-else">
			<text class="detail-name">{{selectedFood.name}}</text>
			<text class="detail-old">月售{{selectedFood.monthSaled}}份</text>
		</view>
		<view class="selectdetail-desc" style="padding-bottom: 20rpx;">
			<text class="detail-name" style="color:#f01414">￥{{tage.sortGoodsSpecList(selectedFood.goodsSpecList).price}}</text>
			<text class="detail-old">￥{{selectedFood.now}}</text>
		</view>
		<view class="cartcontrol-wrapper cartcontrol-button" style="background: #fff">
			<view wx:if="{{merchantInfoObj.businessStatus === 1 || merchantInfoObj.status=== 0}}" class="choice-else font-10"  ><!--如果代理商不允许它开业，或者它自己是休息状态：即显示商家休息-->
				<text>商家休息中</text>
			</view>
			<!-- else 在营业（if有可能规格一个的已售罄（及不再售卖）/正常卖）-->
			<view wx:elif="{{selectedFood.status === 0 || (selectedFood.status === 0 || selectedFood.goodsSpecList.length === 1 && selectedFood.goodsSpecList[0].stockType && !selectedFood.surplusDiscountStock && selectedFood.goodsSpecList[0].stock === 0 )}}" class="choice-else font-10">	
				<text>商品已售罄</text><!--不再售卖 或 （针对规格只有一个的，并且库存状态是有限的，并且不是折扣商品已卖完，并且库存数为0）-->
			</view>
			<!--else 正常卖-->
			<view wx:else class="flex" style="align-items:center">
				<template is="contorl-add" data="{{food:selectedFood,selectFoods,topStatus:true}}" ></template> <!--+购买图标-->
				<!--if有可能要选规格-->
				<view wx:if="{{selectedFood.goodsSpecList.length >1 || selectedFood.goodsAttributeList.length >=1}}" class="choice font-10 top-status" data-food="{{selectedFood}}"  catchtap="choice">
					<text>选规格</text>
				</view>
			</view>  
		</view>
	</view>
	<!--底下遮罩-->
	<view wx:if="{{choice || detailShow || merchantRedBagList.length != 0 || pickertag}}" animation="{{maskAnimation}}" class="mask" bindtap="close" catchtouchmove="myCatchTouch">	
	</view>
	<!--选择规格弹窗-->
	<view wx:if="{{choice}}" animation="{{choiceAnimation}}" class="shoprules font-16" catchtouchmove="myCatchTouch">
		<view class="shoprules-title">
			<text>{{selectedFood.name}}</text>
			<image class="shoprules-img" src="../../images/images/close.png" bindtap="close"></image>
		</view>
		<scroll-view scroll-y="true" catchtouchmove="myCatchTouch">
			<view class="shoprules-wrapper font-14" catchtouchmove="myCatchTouch">
				<view class="shoprules-content-rules">
					<view class="shoprules-text">
						<text>规格 :</text>
					</view>
					<view class="shoprules-options font-14"
						wx:for="{{selectedFood.goodsSpecList}}" 
						wx:for-item="taste" 
						wx:for-index="index" 
						wx:key="index">
						<text class="shoprules-select {{index===specIndex ? 'shoprules-active' : ''}}" 
							bindtap="choicespec"
							data-index="{{index}}"
							data-taste="{{taste}}">{{taste.spec}}
						</text>
					</view>
					<view class="shoprules-messgae font-10">
						<text wx:if="{{selectedFood.hasDiscount === 0 && selectedFood.goodsSpecList[specIndex].orderLimit}}" class="rules-text" style="color:#cd5c78;border: 1rpx solid #cd5c78">每单限购{{selectedFood.goodsSpecList[specIndex].orderLimit}}份</text>
						<text wx:if="{{selectedFood.hasDiscount === 1 && selectedFood.everyGoodsEveryOrderBuyCount> 0}}" class="rules-text" style="color:#cd5c78;border: 1rpx solid #cd5c78">每单限购{{selectedFood.everyGoodsEveryOrderBuyCount}}份</text>
						<text wx:if="{{selectedFood.goodsSpecList[specIndex].stockType && selectedFood.goodsSpecList[specIndex].stock <10 && selectedFood.hasDiscount === 0}}" class="rules-text" style="color:#fff;border: 1rpx solid #ff4849;background: #ff4849">仅剩{{selectedFood.goodsSpecList[specIndex].stock}}件</text>
						<text wx:if="{{selectedFood.goodsSpecList[specIndex].minOrderNum && selectedFood.hasDiscount === 0}}" class="rules-text" style="color:#fb9a00;border: 1rpx solid #fb9a00">{{selectedFood.goodsSpecList[specIndex].minOrderNum}}份起购</text>
					</view>
				</view>
				<view class="shoprules-content"
					wx:for="{{selectedFood.goodsAttributeList}}" 
					wx:for-item="item" 
					wx:for-index="parentindex" 
					wx:key="parentindex">
					<view class="shoprules-text">
						<text>{{item.title}} :</text>
					</view>
					<view class="shoprules-options font-14">
						<text class="shoprules-select {{item.select == taste ? 'shoprules-active' : ''}}" 
							wx:for="{{tage.splitStr(item.name)}}" 
							wx:for-item="taste" 
							wx:for-index="index" 
							wx:key="index"
							bindtap="choiceTaste"
							data-parentindex = "{{parentindex}}"
							data-taste="{{taste}}">{{taste}}
						</text>
					</view>
				</view>	
			</view>
		</scroll-view>
		<view class="shoprules-food">
			<view  class="shoprules-left font-18">
				<text>￥{{selectedFood.goodsSpecList[specIndex].price}}</text><text wx:if="{{selectedFood.goodsSpecList[specIndex].originalPrice}}" class="old-price">￥{{selectedFood.goodsSpecList[specIndex].originalPrice}}</text>
			</view>
			<view class="button flex">
				<!-- <image class="button-img" src="../../images/images/cart_2.png"></image> -->
				<text wx:if="{{tage.getstandard(selectedFood,specIndex,selectFoods)===0}}" class="button-txt" bindtap="addCart" data-rules="{{true}}" data-food="{{selectedFood}}" data-specindex="{{specIndex}}">加入购物车</text>
				<view wx:if="{{tage.getstandard(selectedFood,specIndex,selectFoods)>0}}" class="cartcontrol-wrapper" style="height: 62rpx">
					<view>
						<view wx:if="{{tage.getstandard(selectedFood,specIndex,selectFoods)>0}}" class="cart-decrease" data-food="{{selectedFood}}" data-specindex="{{specIndex}}" data-rules="{{true}}" catchtap="decrease">
							<image class="icon-add_circle" src="/images/images/decrease.png"></image>
						</view>
						<view wx:if="{{tage.getstandard(selectedFood,specIndex,selectFoods)>0}}" class="cart-count">
							<text>{{tage.getstandard(selectedFood,specIndex,selectFoods)}}</text>
						</view>
						<view class="cart-add" data-rules="{{true}}" data-specindex="{{specIndex}}"data-food="{{selectedFood}}" catchtap="addCart">
							<image class="icon-add_circle" src="/images/images/add.png"></image>
						</view>
					</view>
				</view>
			</view>
		</view>
	</view>
	<!-- 天降红包-->
	<view class="redbag" wx:if="{{merchantRedBagList.length != 0}}" animation="{{orderRedAnimation}}" catchtouchmove="myCatchTouch">
		<view class="redbag-close">
			<image class="redbag-close-img" catchtap="close" src="../../images/images/close_red.png"></image>
		</view>
		<view class="redbag-header">
			<image class="redbag-img" src="../../images/images/shop_redbag.png"></image>
		</view>
		<view style="background: #e3003a;border-radius:0 0 20rpx 20rpx;overflow: hidden;">
			<view class="redbag-content"
				wx:for="{{merchantRedBagList}}" 
				wx:for-item="item" 
				wx:for-index="index"
				wx:key="index" >
				<view class="lottery-content flex">
					<view class="lottery-icon" style="color: #ff3e4a">
						<text style="font-size:36rpx">￥</text>
						<text style="font-size:60rpx">{{item.amt}}</text>
					</view>
					<view class="lottery-content-right font-14">
						<view class="lottery-content-text">{{item.name}}</view>
						<view class="money" >{{item.useRule}}</view>
						<view class="get-redbag font-10 {{item.isReceive === '已领取' ? 'receive' : ''}}" bindtap="getMerchantRedBag" data-item="{{item}}" data-index="{{index}}">
							<text>{{item.isReceive}}</text>
						</view>
					</view>
				</view>
			</view>
			<view class="redbag-food">
				<text>恭喜获得天降红包，可抵扣在线支付时的订单金额</text>
			</view>
		</view>
	</view>
	<template is="showToast" data="{{showToast: showToast}}" />
	<template is="activity" data="{{pickertag,itemList:merchantInfoObj,pickertagAnimation}}" />
</view>