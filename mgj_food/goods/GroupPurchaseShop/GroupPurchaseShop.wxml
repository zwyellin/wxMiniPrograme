<import src="../../components/star/star.wxml" />

<wxs module="fixed" src="../../utils/star.wxs"></wxs>

<view class="container"> 
    <view class="merchantInfo">
        <view class="merchantMainInfo">
            <!--商家一张图片时布局-->
            <view wx:if="{{merchantInfoObj.images.length <= 1}}" >
                <view class="flex flex-spaceBetween">
                    <view class="merchantMainInfo_license">
                        <text>{{merchantInfoObj.name}}</text>
                        <view class="merchantStar">
                            <template is="star-AttrScore" data="{{size:36,item:merchantInfoObj,AttrName:'averageScore'}}"></template>
                            <text>人均￥{{merchantInfoObj.averageConsume}}</text>
                        </view>
                        <view class="businessHours">
                            <text>营业时间:{{merchantInfoObj.businessHours}}</text>
                        </view>
                    </view>
                    <view class="merchantMainInfo_image">                   
                        <block
                            wx:for="{{merchantInfoObj.showImages}}"
                            wx:for-index="index"
                            wx:for-item="item"
                            wx:key="index"
                        >
                            <image src="{{item}}"></image>
                        </block>
                    </view>
                </view>
                <view wx:if="{{merchantInfoObj.type==1}}" class="merchantMainInfo_type">
                    <image src="../image/外卖标识.png"></image>
                    <navigator open-type="navigate" url="/goods/GroupPurchaseShop/GroupPurchaseShop" style="display:inline-block">  外卖  ></navigator>	
                </view>
            </view>

             <!--商家多张图片时布局-->
            <view wx:else>
                <view class="merchantMainInfo_license">
                    <text>{{merchantInfoObj.name}}</text>
                    <view class="merchantStar flex flex-spaceBetween">
                        <view>
                            <template is="star-AttrScore" data="{{size:36,item:merchantInfoObj,AttrName:'averageScore'}}"></template>
                            <text>人均￥{{merchantInfoObj.averageConsume}}</text>
                        </view>
                        <text>营业时间:{{merchantInfoObj.businessHours}}</text>   
                    </view>
                </view>
                <view wx:if="{{merchantInfoObj.type==1}}" class="merchantMainInfo_type">
                    <image src="../image/外卖标识.png"></image>
                    <navigator open-type="navigate" url="/goods/GroupPurchaseShop/GroupPurchaseShop" style="display:inline-block">  外卖  ></navigator>	
                </view>
                <view class="merchantMainInfo_image ">
                    <view class="flex flex-spaceBetween">                
                        <block
                            wx:for="{{merchantInfoObj.showImages}}"
                            wx:for-index="index"
                            wx:for-item="item"
                            wx:key="index"
                        >
                            <image src="{{item}}" data-index="{{index}}" data-images="{{merchantInfoObj.showImages}}" catch:tap="merchantInfoImageTap"></image>
                        </block>
                    </view>
                    <view class="merchantMainInfo_image_TotalIcon" data-images="{{merchantInfoObj.showImages}}" catch:tap="merchantInfoImageTap">
                        <image src="../image/imagesIcon.png" style="width:30rpx;height:30rpx;"></image>
                        {{merchantInfoObj.images.length}}
                    </view>
                </view>
            </view>
        </view> <!--merchantMainInfo结束-->
        <view class="merchantInfoContactWay flex flex-spaceBetween">
            <navigator  class="merchantInfoAddress"
            open-type="navigate"
            url="/goods/mapview/mapview?latitude={{merchantInfoObj.latitude}}&longitude={{merchantInfoObj.longitude}}&name={{merchantInfoObj.name}}"
            >
                <image src="../../images/images/map_1.png" style="width:40rpx;height:40rpx"></image>
                {{merchantInfoObj.address}}
                <text style="border-left: 1px solid grey;padding: 0 15rpx;color: grey;">距您{{fixed.round(merchantInfoObj.distance)}}km</text>
            </navigator>
            <view class="merchantInfoTel" style="padding:10rpx 20rpx;background:grey" catch:tap="callPhoneTap">
                <image src="../image/电话@2x.png" style="width:60rpx;height:60rpx;"></image>
            </view>
        </view>
    </view><!--merchantInfo商家信息头部布局完毕-->
    <!--服务类别部分开始布局-->
    <view class="serviceCategory mt20"> 
        <block 
        wx:for="{{merchantInfoObj.serverType}}"
        wx:for-index="index"
        wx:for-item="item"
        wx:key="index">
            <!-- 在线支付 -->
            <view wx:if="{{item.type==0}}" class="flex flex-spaceBetween mt20">
                <!-- 左边 -->
                <view>     
                    <view class="serviceCategory_typeIcon">
                        <image src="../image/买@2x.png"></image>
                        <text>在线支付</text>
                    </view>
                    <text>{{item.discount}}折</text>
                </view>
                <!-- 右边 -->
                <view class="flex flex-all-center">
                    <button size="mini">优惠买单</button>
                    <text>已售{{item.sold}}</text>
                </view>
            </view>
            <!-- 代金券 -->
            <view wx:if="{{item.type==1}}" class="mt20">
                <view class="serviceCategory_typeIcon">
                    <image src="../image/代@2x.png"></image>
                    <text>代金券</text>
                </view>
                <view class="flex flex-spaceBetween">
                    <!-- 左边 -->
                    <view > 
                        <text>{{item.total}} 代金券</text>
                        <view >
                            <text wx:for="{{item.tags}}"
                            wx:for-index="tagIndex"
                            wx:for-item="tagItem"
                            wx:key="tagIndex"
                            style="padding:0 10rpx;{{tagIndex==0 ? 'padding-left:0;':'border-left:1px solid grey;'}};"
                            >{{tagItem}}</text>
                        </view>
                        <text>￥{{item.value}}</text>
                    </view>
                    <!-- 右边 -->
                    <view class="flex flex-all-center">
                        <button size="mini">购买</button>
                        <text>已售{{item.sold}}</text>
                    </view>
                </view>
            </view>
            <!-- 团购套餐 -->
            <view wx:if="{{item.type==2}}" class="mt20">
                <view class="serviceCategory_typeIcon">
                    <image src="../image/团@2x.png"></image>
                    <text>团购套餐</text>
                </view>
                <view class="flex flex-spaceBetween">
                    <!-- 左边 -->
                    <image src="{{item.img}}" style="width:200rpx;height:200rpx;flex:0 0 auto"></image>
                    <!-- 右边 -->
                    <view class="flex flex-spaceBetween" style="flex:1;margin-left:20rpx">
                        <!-- 左边 -->
                        <view>
                            <text>{{item.name}}</text>
                            <view>
                                <text wx:for="{{item.tags}}"
                                wx:for-index="tagIndex"
                                wx:for-item="tagItem"
                                wx:key="tagIndex"
                                style="padding:0 10rpx;{{tagIndex==0 ? 'padding-left:0;':'border-left:1px solid grey;'}};"
                                >{{tagItem}}</text>
                            </view>
                            <view>
                                <text>￥{{item.value}}</text>
                                <text>门市价￥{{item.total}}</text>
                            </view>
                        </view>
                        <!-- 右边 -->
                        <view class="flex flex-all-center">
                            <button size="mini">购买</button>
                            <text>已售{{item.sold}}</text>
                        </view>
                    </view>
                </view>
            </view>
        </block>
    </view><!--服务种类布局完毕-->
    <!-- 商家推荐 -->
    <view class="merchantCard"> 
        <text>商家推荐</text>
        <view>
            <text wx:for="{{merchantRecommend}}"
            wx:for-index="index"
            wx:for-item="item"
            wx:key="index"
           style="padding:0 10rpx;{{index==0 ? 'padding-left:0;':'border-left:1px solid grey;'}};"
            >{{item}}</text>
        </view>
    </view>
    <!-- 商家服务 -->
    <view class="merchantCard"> 
        <text>商家服务</text>
        <view class="flex flex-spaceBetween" style="flex-wrap:wrap">
            <image wx:for="{{merchantServe}}"
            wx:for-index="index"
            wx:for-item="item"
            wx:key="index"    
            src="../image/商家服务-{{item}}@2x.png"
            style="width:60rpx;height:60rpx;{{(index+1)%5==4 ? '':'padding-right:90rpx;'}}"
            ></image>
        </view>
    </view>
</view>